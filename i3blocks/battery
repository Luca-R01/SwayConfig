#!/bin/bash

# Prendere informazioni sulla batteria
BAT="BAT0"
BAT_PERC=$(cat /sys/class/power_supply/$BAT/capacity)
BAT_STATUS=$(cat /sys/class/power_supply/$BAT/status)
PROFILE=$(powerprofilesctl get)

# Controllo se la batteria è presente
if [[ -z "$BAT_PERC" ]]; then
	echo ""
	exit 0
fi

# Impostazioni predefinite
COLOR="#FFFFFF"

# Controllo dello stato della batteria
if [[ $BAT_STATUS = Charging ]]; then
	COLOR="#FFFF00"
	CHARGE_ICON=" "
elif [[ $BAT_STATUS = Full ]]; then
	COLOR="#4AF626"
elif [[ $BAT_PERC -le 30 ]]; then
	COLOR="#FF0000"
fi

# Calcolo dell'icona della batteria
if [[ $BAT_PERC -le 20 ]]; then
	BAT_ICON=""
elif [[ $BAT_PERC -le 40 ]]; then
	BAT_ICON=""
elif [[ $BAT_PERC -le 60 ]]; then
	BAT_ICON=""
elif [[ $BAT_PERC -le 80 ]]; then
	BAT_ICON=""
else
	BAT_ICON=""
fi

# Output
echo "$CHARGE_ICON$BAT_ICON $BAT_PERC%" && echo "" && echo "$COLOR"

# Mouse click event
case $BLOCK_BUTTON in
	3)
		message=$(acpi)
		message="$message 
Profilo:  $PROFILE"
		notify-send "$message"
		;;
esac
